Train metrics for epoch 0:
Average Accuracy: 0.7192
Mean Average Precision (MAP): 0.3083
Area Under ROC Curve (AUC): 0.5008
Label 1:
  Accuracy: 0.6844
  Precision: 0.7500
  Recall: 0.8727
Label 2:
  Accuracy: 0.4900
  Precision: 0.5727
  Recall: 0.1097
Label 3:
  Accuracy: 0.6290
  Precision: 0.3027
  Recall: 0.1797
Label 4:
  Accuracy: 0.7477
  Precision: 0.1311
  Recall: 0.1479
Label 5:
  Accuracy: 0.8477
  Precision: 0.1311
  Recall: 0.1406
Label 6:
  Accuracy: 0.9163
  Precision: 0.0101
  Recall: 0.0109
Train Loss: 0.5975
Val metrics for epoch 0:
Average Accuracy: 0.7875
Mean Average Precision (MAP): 0.3028
Area Under ROC Curve (AUC): 0.4965
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.4781
  Precision: 0.5081
  Recall: 0.4661
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4751
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 1:
Average Accuracy: 0.7849
Mean Average Precision (MAP): 0.3084
Area Under ROC Curve (AUC): 0.5024
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5188
  Precision: 0.5365
  Recall: 0.6076
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4744
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 1:
Average Accuracy: 0.7941
Mean Average Precision (MAP): 0.3050
Area Under ROC Curve (AUC): 0.5010
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5174
  Precision: 0.5342
  Recall: 0.6949
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4499
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 2:
Average Accuracy: 0.7629
Mean Average Precision (MAP): 0.3088
Area Under ROC Curve (AUC): 0.5031
Label 1:
  Accuracy: 0.7140
  Precision: 0.7520
  Recall: 0.9267
Label 2:
  Accuracy: 0.5330
  Precision: 0.5406
  Recall: 0.7308
Label 3:
  Accuracy: 0.6729
  Precision: 0.2945
  Recall: 0.0633
Label 4:
  Accuracy: 0.8163
  Precision: 0.1286
  Recall: 0.0579
Label 5:
  Accuracy: 0.8902
  Precision: 0.1111
  Recall: 0.0417
Label 6:
  Accuracy: 0.9509
  Precision: 0.0476
  Recall: 0.0109
Train Loss: 0.7140
Val metrics for epoch 2:
Average Accuracy: 0.7961
Mean Average Precision (MAP): 0.3045
Area Under ROC Curve (AUC): 0.5000
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5297
  Precision: 0.5297
  Recall: 1.0000
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4524
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 3:
Average Accuracy: 0.7900
Mean Average Precision (MAP): 0.3100
Area Under ROC Curve (AUC): 0.5053
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5489
  Precision: 0.5435
  Recall: 0.8751
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4597
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 3:
Average Accuracy: 0.7922
Mean Average Precision (MAP): 0.3039
Area Under ROC Curve (AUC): 0.4987
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5062
  Precision: 0.5246
  Recall: 0.7225
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4502
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 4:
Average Accuracy: 0.7888
Mean Average Precision (MAP): 0.3108
Area Under ROC Curve (AUC): 0.5067
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5423
  Precision: 0.5609
  Recall: 0.5865
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4541
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 4:
Average Accuracy: 0.7901
Mean Average Precision (MAP): 0.3038
Area Under ROC Curve (AUC): 0.4985
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.4938
  Precision: 0.5216
  Recall: 0.5381
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4519
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 5:
Average Accuracy: 0.7898
Mean Average Precision (MAP): 0.3110
Area Under ROC Curve (AUC): 0.5072
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5480
  Precision: 0.5602
  Recall: 0.6439
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4588
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 5:
Average Accuracy: 0.7952
Mean Average Precision (MAP): 0.3051
Area Under ROC Curve (AUC): 0.5011
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5241
  Precision: 0.5337
  Recall: 0.8051
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4541
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 6:
Average Accuracy: 0.7871
Mean Average Precision (MAP): 0.3093
Area Under ROC Curve (AUC): 0.5041
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5321
  Precision: 0.5434
  Recall: 0.6759
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4514
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 6:
Average Accuracy: 0.7967
Mean Average Precision (MAP): 0.3049
Area Under ROC Curve (AUC): 0.5007
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5331
  Precision: 0.5319
  Recall: 0.9894
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4543
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 7:
Average Accuracy: 0.7908
Mean Average Precision (MAP): 0.3105
Area Under ROC Curve (AUC): 0.5064
Label 1:
  Accuracy: 0.7548
  Precision: 0.7548
  Recall: 1.0000
Label 2:
  Accuracy: 0.5538
  Precision: 0.5480
  Recall: 0.8523
Label 3:
  Accuracy: 0.6994
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.4552
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 7:
Average Accuracy: 0.7955
Mean Average Precision (MAP): 0.3046
Area Under ROC Curve (AUC): 0.5002
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5264
  Precision: 0.5303
  Recall: 0.9280
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4543
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 8:
Average Accuracy: 0.7769
Mean Average Precision (MAP): 0.3118
Area Under ROC Curve (AUC): 0.5087
Label 1:
  Accuracy: 0.7508
  Precision: 0.7551
  Recall: 0.9912
Label 2:
  Accuracy: 0.5463
  Precision: 0.5559
  Recall: 0.6709
Label 3:
  Accuracy: 0.6746
  Precision: 0.3627
  Recall: 0.1090
Label 4:
  Accuracy: 0.8353
  Precision: 0.1139
  Recall: 0.0289
Label 5:
  Accuracy: 0.9013
  Precision: 0.0811
  Recall: 0.0156
Label 6:
  Accuracy: 0.9531
  Precision: 0.0625
  Recall: 0.0109
Train Loss: 0.6888
Val metrics for epoch 8:
Average Accuracy: 0.7944
Mean Average Precision (MAP): 0.3039
Area Under ROC Curve (AUC): 0.4987
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5196
  Precision: 0.5258
  Recall: 0.9513
Label 3:
  Accuracy: 0.7183
  Precision: 0.0000
  Recall: 0.0000
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4545
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Train metrics for epoch 9:
Average Accuracy: 0.7897
Mean Average Precision (MAP): 0.3116
Area Under ROC Curve (AUC): 0.5081
Label 1:
  Accuracy: 0.7539
  Precision: 0.7548
  Recall: 0.9982
Label 2:
  Accuracy: 0.5489
  Precision: 0.5666
  Recall: 0.5958
Label 3:
  Accuracy: 0.6985
  Precision: 0.4375
  Recall: 0.0103
Label 4:
  Accuracy: 0.8623
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9150
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9593
  Precision: 0.0000
  Recall: 0.0000
Train Loss: 0.6063
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Val metrics for epoch 9:
Average Accuracy: 0.7770
Mean Average Precision (MAP): 0.3027
Area Under ROC Curve (AUC): 0.4950
Label 1:
  Accuracy: 0.7722
  Precision: 0.7722
  Recall: 1.0000
Label 2:
  Accuracy: 0.5051
  Precision: 0.5244
  Recall: 0.7055
Label 3:
  Accuracy: 0.6285
  Precision: 0.2260
  Recall: 0.1315
Label 4:
  Accuracy: 0.8586
  Precision: 0.0000
  Recall: 0.0000
Label 5:
  Accuracy: 0.9226
  Precision: 0.0000
  Recall: 0.0000
Label 6:
  Accuracy: 0.9753
  Precision: 0.0000
  Recall: 0.0000
Val Loss: 0.4719
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Traceback (most recent call last):
  File "/home/RadChest/code/main.py", line 79, in <module>
  File "/home/RadChest/code/main.py", line 48, in main
    GCNtrain(model=model, traindataloader=train_loader, criterion=criterion, traindataset=train_dataset, optimizer=optimizer, device=device, num_epochs=config['n_epochs'],labels=labels, valdataset= val_dataset, valdataloader=val_loader, num_workers=config['num_workers'],save_dir=save_dir, testdataloader=test_loader, testdataset=test_dataset)
  File "/home/RadChest/code/train/GCNtrain.py", line 109, in GCNtrain
    model, optimizer, start_epoch = load_checkpoint(model, optimizer, f"{save_dir}/model_{best_val_map_epoch}.pth", device)
  File "/home/RadChest/code/utils.py", line 32, in load_checkpoint
    checkpoint = torch.load(load_path, map_location=device)
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 986, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 435, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 416, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: "/scratch/RadChest/checkpoints/model_GCN_lr_2e-05_bs_512_epochs_10_labels_['nodule', 'opacity', 'atelectasis', 'consolidation', 'mass', 'pneumothorax']_05-09-2024_18-58-35/model_6.pth"