Train metrics for epoch 0:
Average Accuracy: 0.7264
Mean Average Precision (MAP): 0.2131
Area Under ROC Curve (AUC): 0.5033
Label 1:
  Accuracy: 0.6158
  Precision: 0.7569
  Recall: 0.7232
Label 2:
  Accuracy: 0.5122
  Precision: 0.5489
  Recall: 0.3932
Label 3:
  Accuracy: 0.6866
  Precision: 0.2041
  Recall: 0.0147
Label 4:
  Accuracy: 0.7981
  Precision: 0.1498
  Recall: 0.0997
Label 5:
  Accuracy: 0.6609
  Precision: 0.0742
  Recall: 0.2604
Label 6:
  Accuracy: 0.9367
  Precision: 0.0000
  Recall: 0.0000
Label 7:
  Accuracy: 0.8212
  Precision: 0.1724
  Recall: 0.0130
Label 8:
  Accuracy: 0.6286
  Precision: 0.3229
  Recall: 0.1419
Label 9:
  Accuracy: 0.5972
  Precision: 0.0236
  Recall: 0.3443
Label 10:
  Accuracy: 0.8384
  Precision: 0.0847
  Recall: 0.0688
Label 11:
  Accuracy: 0.9730
  Precision: 0.4000
  Recall: 0.0333
Label 12:
  Accuracy: 0.7375
  Precision: 0.2152
  Recall: 0.1030
Label 13:
  Accuracy: 0.8216
  Precision: 0.1017
  Recall: 0.2975
Label 14:
  Accuracy: 0.9181
  Precision: 0.0323
  Recall: 0.0157
Label 15:
  Accuracy: 0.5286
  Precision: 0.3419
  Recall: 0.4605
Label 16:
  Accuracy: 0.5803
  Precision: 0.1798
  Recall: 0.3683
Label 17:
  Accuracy: 0.6937
  Precision: 0.2727
  Recall: 0.0784
Train Loss: 2.8775
Val metrics for epoch 0:
Average Accuracy: 0.6825
Mean Average Precision (MAP): 0.2115
Area Under ROC Curve (AUC): 0.4952
Label 1:
  Accuracy: 0.5971
  Precision: 0.7710
  Recall: 0.6802
Label 2:
  Accuracy: 0.4714
  Precision: 0.5046
  Recall: 0.1165
Label 3:
  Accuracy: 0.6891
  Precision: 0.2400
  Recall: 0.0478
Label 4:
  Accuracy: 0.4747
  Precision: 0.1437
  Recall: 0.5476
Label 5:
  Accuracy: 0.7138
  Precision: 0.0694
  Recall: 0.2174
Label 6:
  Accuracy: 0.9675
  Precision: 0.0000
  Recall: 0.0000
Label 7:
  Accuracy: 0.8227
  Precision: 0.0000
  Recall: 0.0000
Label 8:
  Accuracy: 0.6734
  Precision: 0.3333
  Recall: 0.0139
Label 9:
  Accuracy: 0.5903
/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Traceback (most recent call last):
  File "/home/RadChest/code/main.py", line 81, in <module>
    main(run_name=run_name)
  File "/home/RadChest/code/main.py", line 51, in main
    GCNtrain(model=model, traindataloader=train_loader, criterion=criterion, traindataset=train_dataset, optimizer=optimizer, device=device, num_epochs=config['n_epochs'],labels=labels, valdataset= val_dataset, valdataloader=val_loader, num_workers=config['num_workers'],save_dir=save_dir, testdataloader=test_loader, testdataset=test_dataset)
  File "/home/RadChest/code/train/GCNtrain.py", line 106, in GCNtrain
    save_checkpoint(model, optimizer, save_dir, epoch+1)
  File "/home/RadChest/code/utils.py", line 28, in save_checkpoint
    torch.save(checkpoint, f"{save_dir}/{model}_{epoch}.pth")
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/root/miniconda3/envs/pytorch2/lib/python3.10/site-packages/torch/serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: File /scratch/RadChest/checkpoints/model_GAT_lr_2e-05_bs_64_epochs_10_labels_17_05-09-2024_19-35-21/GAT(
  (gat1): GATConv(2048, 1024, heads=3)
  (gat2): GATConv(3072, 512, heads=1)
  (fc1): Linear(in_features=512, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=128, bias=True)
  (fc3): Linear(in_features=128, out_features=64, bias=True)
  (fc4): Linear(in_features=64, out_features=17, bias=True)
)_1.pth cannot be opened.